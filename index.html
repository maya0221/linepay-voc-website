<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LINE Pay VOC Insights Dashboard</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <script type="importmap">
    {
        "imports": {
            "react": "https://esm.sh/react@18.2.0",
            "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
            "recharts": "https://esm.sh/recharts@2.12.3?external=react,react-dom",
            "lucide-react": "https://esm.sh/lucide-react@0.358.0",
            "xlsx": "https://esm.sh/xlsx@0.18.5"
        }
    }
    </script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body { font-family: 'Pretendard', sans-serif; background-color: #f8fafc; color: #1e293b; }
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useMemo } from 'react';
        import { createRoot } from 'react-dom/client';
        import { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Cell, PieChart, Pie } from 'recharts';
        import { Download, Copy, Search, Filter, TrendingUp, MessageSquare, Globe, Smile, Meh, Frown, ChevronLeft, ChevronRight } from 'lucide-react';
        import * as XLSX from 'xlsx';

        // --- Mock Data (샘플 데이터) ---
        const MOCK_DATA = Array.from({ length: 150 }).map((_, i) => ({
            id: i,
            source: ['Facebook', 'App Store', 'Threads', 'Play Store'][i % 4],
            date: `2024-03-${((i % 28) + 1).toString().padStart(2, '0')}`,
            country: ['TW', 'TH', 'JP', 'Global'][i % 4],
            sentiment: ['Positive', 'Neutral', 'Negative'][Math.floor(Math.random() * 3)],
            category: ['Payment UX', 'Merchant Network', 'Promotion', 'Account Setup'][i % 4],
            content: `User feedback regarding LINE Pay service #${i+1}. The UI responsiveness and transaction speed were mentioned.`,
            translation: `LINE Pay 서비스에 대한 사용자 피드백 #${i+1}입니다. UI 반응 속도와 거래 속도에 대한 언급이 있었습니다.`
        }));

        const App = () => {
            const [filter, setFilter] = useState('All');
            const [page, setPage] = useState(1);
            
            // 필터링 로직
            const filteredData = useMemo(() => {
                return MOCK_DATA.filter(d => filter === 'All' || d.country === filter);
            }, [filter]);
            
            // 차트 데이터 계산
            const sentimentStats = [
                { name: 'Positive', count: filteredData.filter(d => d.sentiment === 'Positive').length, color: '#00B900' },
                { name: 'Neutral', count: filteredData.filter(d => d.sentiment === 'Neutral').length, color: '#94a3b8' },
                { name: 'Negative', count: filteredData.filter(d => d.sentiment === 'Negative').length, color: '#ef4444' }
            ];

            // 엑셀 다운로드 기능
            const downloadExcel = () => {
                const ws = XLSX.utils.json_to_sheet(filteredData);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, "VOC_Data");
                XLSX.writeFile(wb, `LINE_Pay_VOC_Report.xlsx`);
            };

            // 페이지네이션
            const perPage = 10;
            const totalPages = Math.ceil(filteredData.length / perPage);
            const paginatedData = filteredData.slice((page - 1) * perPage, page * perPage);

            return (
                <div className="min-h-screen flex flex-col">
                    {/* Header */}
                    <header className="h-16 bg-white border-b sticky top-0 z-50 px-6 flex items-center justify-between shadow-sm">
                        <div className="flex items-center gap-3">
                            <div className="w-9 h-9 bg-[#00B900] rounded-xl flex items-center justify-center text-white shadow-lg">
                                <TrendingUp size={20} />
                            </div>
                            <h1 className="text-xl font-black text-slate-900 tracking-tight">LINE PAY VOC INTELLIGENCE</h1>
                        </div>
                        <button onClick={downloadExcel} className="flex items-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-lg text-xs font-bold hover:bg-slate-700 transition active:scale-95">
                            <Download size={14} /> Excel Export
                        </button>
                    </header>

                    {/* Main Content */}
                    <main className="flex-1 p-6 max-w-[1600px] mx-auto w-full space-y-6">
                        
                        {/* Filter Bar */}
                        <div className="bg-white p-5 rounded-2xl border shadow-sm flex flex-wrap
